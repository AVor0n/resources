## Проект: Чат

Давайте прервем обучение по учебнику Express, чтобы попрактиковаться. На данный момент вы должны знать достаточно, чтобы использовать Express и сделать несколько забавных интерактивных веб-приложений! Мы собираемся создать супер простой чат.

### Задание

1. Используйте `express-generator` для настройки каркаса проекта с шаблонным движком на ваш выбор. Если хотите, вы можете настроить все вручную - это не займет много времени;

2. У нас будет 2 роута: главная (`"/"`) и форма создания нового сообщения (`"/new"`). Генератор должен был создать роут для главной, поэтому найдите этот файл и откройте его. Его можно найти по адресу `routes/index.js`. Там будет строка router.get с `"/"`, который отображает главную. Добавьте туда несколько объявлений;

3. Создайте массив `messages` в верхней части вашего маршрутизатора главной страницы и поместите в него пару сообщений:

~~~javascript
const messages = [
  {
    text: "Всем хай!",
    user: "Вася",
    added: new Date()
  },
  {
    text: "Привет!",
    user: "Петя",
    added: new Date()
  }
];
~~~

4. Затем, на главной (в папке `"views"`) переберите массив сообщений, используя выбранный язык шаблонов. Для каждого сообщения отобразите пользователя, текст и дату добавления. Не забудьте включить ваши сообщения в объект `locals` метода res.render (например, `res.render('index', { title: "Простой чатик", messages: messages })`);

5. После настройте форму нового сообщения. Добавьте обработчик `app.get()` для маршрута `"/new"` и свяжите его с шаблоном `"form"`. В каталоге views создайте шаблон `form`. Добавьте заголовок, 2 поля ввода (имя автора и текст сообщения) и кнопку отправки сообщения. Чтобы форма делала запрос на сервер, вам нужно определить `action` и `method`:

~~~html
<form method="POST" action="/new">
  разместите свои поля ввода и кнопку тут!
</form>
~~~

6. Если вы настроили форму, то при нажатии на кнопку отправки она должна отправить POST-запрос по URL-адресу, указанному в атрибуте `action`, поэтому вернитесь к роутеру главной страницы и добавьте обработчик `app.post()` для `"/new"`;

7. Чтобы получить данные вашей формы, вам необходимо обратиться к объекту `req.body` внутри обработчика `app.post()`. Поля внутри объекта `body` именуются в соответствии с атрибутом `name` ваших полей ввода (значение `<input name="messageText">` будет доступно по аналогичному имени `req.body.messageText` внутри функции `app.post`);

8. В `app.post()` возьмите содержимое формы и поместите его в массив messages:

~~~javascript
messages.push({text: messageText, user: messageUser, added: new Date()});
~~~

9. В конце обработчика `app.post()` добавьте `res.redirect('/')`. Данный вызов отправит пользователя обратно на главную страницу;

10. На этом этапе должна быть возможность перейти на `/new` (можете добавить ссылку на данную страницу с главной), заполнить форму, отправить ее, а затем увидеть новое сообщение на главной странице!

11. Вы почти готовы к развертыванию приложения в Heroku. Перед этим вам нужно сделать пару вещей, чтобы упростить жизнь. Во-первых, нужно указать версию Node, которую вы используете в вашем файле `package.json`. Если вы не помните, просто выведите его с помощью `node -v`. Затем добавьте ее в файл `package.json`:
~~~json
"engines": {
  "node": "10.x.y"
},
~~~

12. Для Heroku обычно требуется `Procfile`, в котором указаны все команды, запускающиеся на старте. В случае с node.js этот файл не обязателен, поскольку Heroku ищет в `package.json` start-скрипт, который уже определен в вашем приложении. Но мы все-равно добавим его в корневой каталог:
```bash
heroku local web
```

13. Вы наконец готовы к развертыванию в Heroku! Сначала проверьте все на локальной машине:
```bash
heroku local web
```

Эта команда запустит ваше приложение локально по адресу http://localhost:5000/. Если все работает нормально, вы можете отправить свое решение на репозиторий Heroku:
```bash
heroku create
git push heroku master
```
