## Express 102: CRUD и MVC

После настройки скелета вашего проекта пришло время настроить базу данных. Как обычно, есть довольно много базовой информации, которую вы изучите по мере продвижения.

### По окончанию

К концу этого урока вы сможете:

- Объяснить, что такое CRUD и как это соотносится с методами HTTP в Express;
- Описать MVC и как все это соотносится с Express;
- Описать, что такое базы данных и ORM, а также как их использовать с приложениями Node / Express;
- Проектировать и создавать свои собственные модели, используя Mongoose;
- Объявлять схему объекта и модели;
- Описать типы полей и стандартную валидацию;
- Перечислить несколько способов доступа к данным модели;
- Протестировать модели, создав несколько экземпляров (используя standalone-скрипт).

### CRUD

CRUD - это концепция, которая часто встречается в веб-разработке, и это та тема, которая может появляться в вопросах на интервью. Поэтому стоит потратить немного времени для изучения данного термина. К счастью, это относительно просто.

CRUD расшифровывается как _Create, Read, Update и Delete_. Это четыре основные операции, которые вы будете использовать в приложениях с базой данных. Если вы разрабатываете интерфейс CRUD, то пользователи могут выполнять эти 4 действия с элементами в базе данных (при условии, что они имеют соответствующие разрешения).

В примере с библиотекой все просто. Мы предоставим возможность пользователям выполнять:
- операцию `create` - создавать записи (добавлять книги, авторов или жанры в базу данных);
- операцию `read` - читать записи (извлекать списки книг из базы данных);
- операцию `update` - обновлять записи (редактировать информацию о книге);
- операцию `delete` - удалять записи (удалить книги из базы данных).

**Но**, это просто концепция, а не обязательное правило, которому нужно следовать. Вы можете не позволить пользователям выполнять определенные действия или ограничить число пользователей, которые могут делать что-либо с элементами базы данных. Например, если вы создаете социальную сеть, вы можете разрешить пользователям __читать__ профиль друзей, но не разрешать удалять эти данные.

Операции CRUD примерно соответствуют методам HTTP, которые вы можете использовать в express-приложении. Все немного гибче, но в целом `create` соотносится с `POST` (или `app.post()` в express-приложении), `read` соотносится с `GET` (`app.get()`) , `update` с `PUT` (`app.put()`) и `delete` с `DELETE` (`app.delete ()`).

### MVC

MVC - это очень распространенная концепция в веб-разработке, которая также может выскочить на интервью. MVC расшифровывается как _Model, View, Controller_ и относится к архитектуре вашего кода. По сути, это способ организовать ваше приложение, поделив его на компоненты 3 типов: модель, представление и контроллер.

**Model** является основным строительным блоком вашей базы данных. Таким образом, для каждой записи в вашей БД (в проекте "Библиотека" это книги, авторы и т.д.) вы создаете модель, которая содержит детали этой записи. Модель определяет тип информации, который используется вашими представлениями и контроллерами.

**View** - компонент, который генерирует пользовательский интерфейс вашего приложения. В нашем случае мы выбрали шаблонизатор, который использует данные, предоставленные контроллером, для отображения нужной информации.

**Controller** - это компонент, которые определяет, какой **view** (представление) отображать и какую информацию в этот View помещать.

#### Пример MVC

Не углубляясь в код, рассмотрим простой сайт для загрузки фотографий. Пользователи могут загружать, а затем просматривать фотографии, которые выведены на главной странице. В этом случае у нас будет модель фотографий, которая будет определять формат хранения в БД. Модель может указать, что фотографии должны быть объектами с полем `filename` (имя файла), `URL` и `date-created` (дата создания).

Нам понадобится 2 представления: главная и страница, которая будут отображать только одну фотографию.

Наш контроллер вызывается каждый раз, когда мы получаем `app.get()`, и определяет, какое представление и изображение отображается на основании данных полученных в запросе от пользователя. Пользователь может запрашивать главную или страница конкретной фотографии.

Если вы сбиты с толку, ничего страшного. Вы будете работать с Model, View и Controller в учебном пособии. Все станет намного понятнее, когда вы поработаете на практике.

### Какую базу данных выбрать?

Важный момент перед тем, как вернуться к учебнику. Express не важно, какую базу данных вы используете. В уроке перечисляется несколько вариантов, но в конечном итоге все ведет к MongoDB. Сейчас выбор БД не имеет большого значения. Если позже вы решите, что предпочитаете использовать SQL или что-то еще, вы сможете довольно легко найти необходимую информацию, прочитав документацию. На данный момент Mongo является самой популярной связкой с Express, поэтому мы рекомендуем просто придерживаться этого пути ниндзя.

### Задание

1. Продолжите с того места [учебника MDN](https://developer.mozilla.org/ru/docs/Learn/Server-side/Express_Nodejs/mongoose), где мы остановились.

### Дополнительные ресурсы

_Этот раздел содержит полезные ссылки на дополнительные материалы. Они не обязательны, так что расценивайте их как нечто полезное, если вы хотите поглубже погрузиться в тему:_

- <span class="btn-fill btn btn-xs btn-success">eng</span> Более подробное объяснение MVC в [статье от freeCodeCamp](https://medium.freecodecamp.org/simplified-explanation-to-mvc-5d307796df30);
- Отличная статья от [hexlet на русском](https://ru.hexlet.io/blog/posts/chto-takoe-mvc-rasskazyvaem-prostymi-slovami).
