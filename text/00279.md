## Классы и объекты

## Введение

Повторим пройденный материал о классах и объектах.

Если говорить простым языком, то можно сказать так: класс - это как техническое описание прибора, купленного вами в электронном дискаунтере.
То, каким он должен быть: материал, форма, список составляющих и т.д.

А объект - это уже непосредственно сам прибор, сделанный **по** техническому описанию, со своим уникальным набором свойств.

Эти свойства уникальны, ведь для каждого прибора они свои. Свойства объекта - это его `состояние`.

Например, если вас попросят описать книгу, то вы скажете, что у каждой книги есть автор, содержание, количество страниц в ней и т.д.
Тем самым вы опишите класс `Книга`. А вот экземпляры книги - это уже конкретные реальные книги, как например, учебник по механике за авторством Дмитрия Васильевича Сивухина. Таких учебников может быть много, у них может отличаться состояние(например, вандал выдрал несколько страниц из книги). Но все эти экземпляры - это экземпляры класса `Книга`.

Теперь посмотрим как в `Java` создать свой собственный класс.

Для того, чтобы объявить класс используется, барабанная дробь, ключевое слово `class`, после него уже идет имя класса.

В `Java` имена классов начинаются с заглавной буквы. В целом, язык позволяет называть классы и не с заглавной буквы, но так не принято и смотреть на вас будут косо.
Относитесь к этому как к джентльменскому соглашению.

Для примера приведем описание класса `Box`, этот класс не содержит никаких свойств и поведения, он демонстрирует только сам процесс объявления:

```java
public class Box {

}
```

> `public` - это так называемый модификатор доступа.
> О них мы также поговорим чуть позднее, но, чтобы не было недопониманий, считайте, что таким образом мы делаем наш класс "публичным", т.е доступным из любой точки программы.

### Static

Мы уже имеем некоторое представление о классах и объектах.

Выше был приведен пример с описанием прибора и самим объектом прибора, как объектом конкретного класса.

Класс **описывает** свойства и методы, принадлежащие объекту. И для каждого объекта эти свойства свои собственные, они уникальные для каждого объекта.

Т.е если у вас есть класс `Car`, у которого есть, например, цвет и год выпуска, то для каждого **объекта** будут свои цвета и модели.
Мимо вас может проехать и красная, и синяя машина разных годов выпуска. Эти свойства **принадлежат** объекту.

Так вот модификатор `static` говорит о том, что свойство или метод принадлежит **классу**, а не объекту.

Классу, Карл!

Это значит, что для обращения к таким полями и методам вам не нужен объект, так как поле/метод к объекту не относится.

> Забегая вперед можно сказать, что класс `Car` - этот такой же объект в `Java`, как и `instance`, объект `Car`.
>
> Т.е классы - это такие же объекты класса `Class`, который имеет свои поля и методы, хранящие некоторую информацию о вашем классе.

Именно поэтому точка входа `main` объявляется как `static`, так как на момент старта вашей программы просто еще не существует никаких объектов, `instance`-ов нашего класса `HelloWorld`.

Но сам класс загружен, сам класс существует на момент загрузки. Поэтому `Java` спокойно запускает наш метод `main` и все.

Теперь поговорим о том, как создать объект(сущность) нашего класса `Box`.

### Создадим экземпляр класса

Чтобы создать `instance` или объект используется ключевое слово `new`:

```java
public class Test {
    public static void main(String[] args) {
        Box box = new Box();
    }
}
```

Обратим внимание на оператор присваивания `=`.

Здесь стоит запомнить, что все, что находится справа от `=` - это объект. В то время как все, что находится слева - это **ссылка**.
Ссылка на объект.

> Это так, если мы не оперируем примитивными типами данных, о которых речь пойдет буквально в следующем параграфе.

Ссылка имеет тип и имя, в нашем примере выше у нас объявляется ссылка с именем `box`, имеющая тип `Box`.

Теперь через ссылку вы можете работать с вашим объектом, вызывая у него методы и получая доступ к свойствам.

По джентльменскому соглашению, которое никто не видел, но все знают, имена переменных, если это не константа, начинаются с строчной буквы и придерживаются стиля [CamelCase](https://ru.wikipedia.org/wiki/CamelCase).

По оформлению мы еще поговорим в дальнейшем.

### Ссылка

Когда создаем экземпляр класса, мы получаем ссылку на этот экземпляр в виде переменной. Что это значит? Это значит, что переменная знает адрес в компьютере, по которому лежит наш экземпляр класса.

![](https://user-images.githubusercontent.com/4215285/72477053-c89ad580-37ff-11ea-8101-7bdcd53a7cc6.jpeg)

Если вы создали две переменных, которые ссылаются на один и тот же объект. То, если вы измените одну переменную, то это повлияет и на другую переменную. Так как они ссылаются на одну и ту же ячейку памяти.

```java
Box box1 = new Box(); // ссылка 1
Box box2 = box1; // ссылка 2
```

![](https://user-images.githubusercontent.com/4215285/72477154-f6801a00-37ff-11ea-8318-9469bcd41282.jpeg)

### Переменные

Класс состоит из переменных, методов и конструкторов. Давайте разберемся, как добавить переменную.

```java
// Автомобиль
class BMW {
    // Переменная класса. Производитель.
    static String manufacturer = "BMW";

    // Переменная экземпляра. Текущая скорость.
    int currentVelocity = 100;
}
```

В данном примере мы добавили 2 переменные: `manufacturer` и `model`:

* `manufacturer` - является переменной класса, так как объявлена с помощью ключевого слова `static`. Переменная класса является общей для всех экземпляров класса. Она инициализируется только один раз во время компиляции класса, поэтому для всех экземпляров доступна только одна копия этой переменной:

  ```java
  BMW car1 = new BMW(); // первый экземпляр
  BMW car2 = new BMW(); // второй экземпляр
  System.out.println(car1.manufacturer); // получим "BMW"
  System.out.println(car1.manufacturer); // получим "BMW"
  System.out.println(BMW.manufacturer); // получим "BMW"
  ```
* `currentVelocity` - переменная экземпляра. Разница с переменными класса заключается в том, что переменные экземпляра обычно инициализируются внутри конструктора класса и не являются общими для всех объектов. Во время создания экземпляра создается новая копия переменной экземпляра.
  ```java
  BMW car1 = new BMW(); // первый экземпляр
  car1.currenVelocity = 50; // меняем скорость
  BMW car2 = new BMW(); // второй экземпляр
  System.out.println(car1.currenVelocity); // 50 - для первого авто значение скорости изменилось
  System.out.println(car2.currenVelocity); // 100 - для второго нет
  ```

### Методы

Метод - это кусок кода, который можно переиспользовать множество раз. По сути описывает поведение объекта. Например: передвижение автомобиля.

Как правило, методы в Java состоят из следующих частей:

* модификатор доступа (необязательно) - `public`, `private`, or `protected`. По умолчанию `package-private` (доступ в пределах своего пакета package);
* возвращаемый тип - обозначает, какое значение возвращает метод. Если ничего не возвращает, указывается ключевое слово `void`. Возвращаемый тип - обязательная часть метода;
* имя метода - следует соглашению CamelCase;
* список параметров - список параметров с их именем и типом. Пустой, если параметры не принимаются;
* Тело метода, окруженное `{}`.

Объявление метода может включать ключевое слово `static`, связывая метод с классом, а не с экземпляром класса.

Обратите внимание, что в отличие от JavaScript, мы **должны** определить тип возвращаемого значения для любого метода, который мы напишем, иначе мы получим ошибку во время компиляции. Если вы не хотите, чтобы метод возвращал что-либо, используйте ключевое слово `void`.

Каждый метод имеет сигнатуру, которая представляет собой комбинацию типа данных, имени и количества аргументов, которые принимает метод.

Скорее всего наиболее узнаваемым методом в Java является `public static void main(String[] args)`.

Этот метод принимает в качестве аргумента массив строк, ничего не возвращает (так как тип возвращаемого значений `void`) и имеет модификатор `static`.

Этот массив строк, который принимает точка входа - это аргументы программы, которые передаются при запуске.

Еще один пример - `public static double ave(double val, double val)`. В данном случае тип данных метода `double` (0.0), имя метода - `ave` (среднее), и он принимает 2 аргумента. Каждый метод **должен** иметь уникальную сигнатуру.

```java
class BMW {
    // У переменных тоже есть
    // модификаторы доступа
    // аналогичные модификаторам методов.
    private String manufacturer = "BMW";
    private String model = "M3";
    private int currentVelocity = 100;

    // Возвращаем модель авто.
    public String getModel(){
        return model;
    }

    // Возвращаем производителя авто.
    public String getManufacturer(){
        return manufacturer;
    }

}
```

Мы можем передавать параметры в метод. Параметры объявляются сразу после имени метода в круглых скобках. Синтаксис для объявления параметров: `Тип Имя`.

```java
class BMW {
    // У переменных тоже есть
    // модификаторы доступа
    // аналогичные модификаторам методов.
    private String manufacturer = "BMW";
    private String model = "M3";
    private int currentVelocity = 100;

    // Передаем в метод новую скорость.
    public int setSpeed(int value) {
        // Задаем новую скорость.
        currentVelocity = value;
    }

    ...
}
```

Как и с любым другим языком, методы (или функции, если вы здесь из мира JavaScript) используются для модульности кода и возможности повторного использования.

Методы служат многим целям, таким как обновление информации в объекте или предоставление данных обратно вызывающей стороне. Вот несколько примеров.

```java
public class Car {
    private int numberOfWheels; // Количество колес.

    // Задаем количество колес.
    public void setNumberOfWheels(int newNumberOfWheels) {
        numberOfWheels = newNumberOfWheels;
    }

    // Выводим количество колес.
    public int getNumberOfWheels() {
        return numberOfWheels;
    }
}
```

В случае `getNumberOfWheels()` тип возвращаемого значения - `int`, который представляет собой целое число. Ключевое слово `return` указывает Java вернуть значение переменной экземпляра `numberOfWheels`.

`setNumberOfWheels(int newNumberOfWheels)` не имеет возвращаемого типа, так как это метод задает значение. Он принимает аргумент типа `int` и задает значение переменной `numberOfWheels` равной `newNumberOfWheels`.

### Конструктор

Что такое конструктор и для чего он нужен?

Конструктор в `Java` играет непосредственную роль при создании объекта.

Имя конструктора аналогично имени класса, а сам синтаксис схож с синтаксисом метода. Однако, конструктор - это не совсем метод, так как у него полностью отсутствует возвращаемое значение.

```java
public class Hello {
    // конструктор
    public Hello() {
        // тело конструктора
    }
}
```

В `Java` у каждого класса есть конструктор, даже если вы явно не объявили его, то `Java` автоматически добавит его за вас - такой конструктор называется `конструктор по умолчанию`.

Поэтому конструкция типа:

```java
public class Hello {
}
```

Будет эквивалентна:

```java
public class Hello {
    public Hello() {
    }
}
```

---

**Вопрос**:

Мы уже поняли, что если не объявить конструктор самому, то `Java` сделает нам конструктор по умолчанию. А если я все-таки объявлю свой собственный конструктор, будет ли у меня конструктор по умолчанию?

**Ответ**:

Нет, не будет.

Как только вы объявляете хотя бы один конструктор, то ответственность за работу с конструкторами, а значит и за то, как будут создаваться объекты этого класса, `Java` с себя снимает.

---

**Вопрос**:

Хорошо, а что если мне нужен и пустой конструктор, похожий на конструктор по умолчанию, и еще парочка конструкторов, принимающих значения в качестве аргументов?

**Ответ**:

В таком случае, вам следует явно объявить каждый конструктор, который вам нужен.

---

Как правило конструктор применяется для присвоения значений свойствам объектов, либо для совершения еще каких-то действий, например, вызова методов или инициализации классов, которые необходимы для создания полностью сформированного объекта.

Для примера рассмотрим класс:

```java
public class Person {
    int age;

    // конструктор, устанавливающий возраст объекту класса Person
    public Person(int age) {
        this.age = age;
    }
}
```

И его использование:

```java
public class Test {
    public static void main(String[] args) {
        Person p = new Person(24);
        System.out.println(p.age);  // 24
    }
}
```

Существует также специальный метод, называемый конструктором, который позволяет устанавливать данные или выполнять операции при создании экземпляра класса. Этот конструктор не имеет возвращаемого типа.

### Override

В `Java` все классы неявно наследуются от класса `Object`.
Сделано это для того, чтобы выделить некоторые общие методы, присущие для всех классов, такие как `toString()`, например.

Но если бы дело ограничивалось только обычным наследованием, это было бы не слишком удобно - как для `toString()`, так и для других методов.
Ведь не всегда то, что мы унаследовали нам подходит - тот же пример с `toString()`.

Для этого в `Java` используется переопределение и перегрузка методов.

Переопределение, как следует из названия, это по сути переписывание (переделываете, переопределяете) *уже* существующего метода, который мы унаследовали от предка.
Для примера возьмем `toString()` - метод возвращающий строковое представление объекта - и следующую модель:

```java
class Person {
  private String name;
  private int age;

  //code
}
```

Если не переопределять метод, то вывод будет в виде `Person@125125d`.

### Практика

Сразу стоит сказать, что эти задачи довольно просты и направлены только на то, чтобы вы ближе познакомились с синтаксисом и привыкли к нему.

#### Выстраивание иерархии

Опишите класс `Student`, у которого есть возраст, имя, принадлежность к ВУЗу.
Опишите также класс `Person`, у которого есть возраст и имя.
Опишите класс `Employee`, у которого есть возраст, имя, зарплата и наименование ВУЗа, который он закончил.

Попробуйте связать все три класса в иерархию, вспомните про инкапсуляцию данных, постарайтесь избежать дублирования кода.

#### Электронная библиотека

Напишите класс, представляющий книжную библиотеку. Библиотека внутри хранит массив книг, книгу можно получить и вернуть, можно запросить список всех книг библиотеки.

У Книги есть идентификатор, название, автор(ы).

> При этом не забудьте про правильное оформление вашего кода.

### Чего стоит опасаться

Остерегайтесь опасной практики, когда один класс становится ответственен за большое количество задач.

Очень часто начинающие разработчики на `Java` объявляют у класса большое количество методов и атрибутов, которые не относятся к классу.

Например, класс `MailSender`, ответственный за рассылку писем, становится ответственен еще и за проверку, за добавление или удаление заголовков у рассылаемых писем.

Такой код будет работать, но это плохая практика. Старайтесь разносить разные области ответственности по разным классам.

Пусть `MailSender` будет ответственен только за рассылку писем, а за проверку будет ответственен другой класс, также как и за добавление/удаление заголовков.

Старайтесь думать над тем, как разбить вашу большую задачу на составляющие.

Выделяйте области ответственности и **делегируйте** их разным классам.

Для более подробного ознакомления с принципами, которые помогут вам писать более правильно читайте в главе SOLID.
